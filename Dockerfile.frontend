# syntax=docker/dockerfile:1

FROM node:20-alpine as build
WORKDIR /app
ENV NODE_ENV=development
COPY frontend/package*.json ./
RUN npm ci --no-audit --no-fund
COPY frontend/ /app/
RUN npm run build

FROM nginx:stable-alpine
COPY --from=build /app/dist /usr/share/nginx/html
EXPOSE 80
HEALTHCHECK --interval=30s --timeout=5s --retries=5 CMD wget -qO- http://localhost/ >/dev/null 2>&1 || exit 1
CMD ["nginx", "-g", "daemon off;"]
